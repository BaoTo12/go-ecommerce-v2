syntax = "proto3";

package inventory.v1;

option go_package = "github.com/titan-commerce/backend/inventory-service/proto/inventory/v1;inventoryv1";

service InventoryService {
  rpc ReserveStock(ReserveStockRequest) returns (ReserveStockResponse);
  rpc CommitReservation(CommitReservationRequest) returns (CommitReservationResponse);
  rpc RollbackReservation(RollbackReservationRequest) returns (RollbackReservationResponse);
  rpc CheckStockAvailability(CheckStockAvailabilityRequest) returns (CheckStockAvailabilityResponse);
  rpc GetStock(GetStockRequest) returns (GetStockResponse);
}

message StockItem {
  string product_id = 1;
  int32 quantity = 2;
}

message ReserveStockRequest {
  repeated StockItem items = 1;
  string reservation_id = 2;
}

message ReserveStockResponse {
  bool success = 1;
  string reservation_id = 2;
  string error_message = 3;
}

message CommitReservationRequest {
  string reservation_id = 1;
}

message CommitReservationResponse {
  bool success = 1;
}

message RollbackReservationRequest {
  string reservation_id = 1;
}

message RollbackReservationResponse {
  bool success = 1;
}

message CheckStockAvailabilityRequest {
  repeated StockItem items = 1;
}

message CheckStockAvailabilityResponse {
  bool available = 1;
  repeated StockItem unavailable_items = 2;
}

message GetStockRequest {
  string product_id = 1;
}

message GetStockResponse {
  int32 available_quantity = 1;
  int32 reserved_quantity = 2;
}
